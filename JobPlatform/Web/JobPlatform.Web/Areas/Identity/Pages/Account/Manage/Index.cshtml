@page
@model IndexModel
@{
    ViewData["Title"] = "Profile";
    ViewData["ActivePage"] = ManageNavPages.Index;
}
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@{
    var user = this.UserManager.GetUserAsync(this.User).Result;
    var url = this.UserManager
        .GetClaimsAsync(user).Result
        .FirstOrDefault(x => x.Type == "ProfilePicture")
        ?.Value.ToString();
}

<h4>@ViewData["Title"]</h4>
<partial name="_StatusMessage" model="Model.StatusMessage" />
<div class="row">
    <div class="col-md-6">
        <div asp-validation-summary="All" class="text-danger"></div>
        <form id="profile-form" method="post" enctype="multipart/form-data">
            @if (@url != null)
            {
                <div class="preview text-center">
                    <img class="preview-img" src="@url" alt="Preview Image" width="200" height="200" />
                    <div class="browse-button">
                        <i class="fa fa-pencil-alt"></i>
                        <input class="browse-input" required type="file" asp-for="PictureFile" />
                    </div>
                </div>
            }
            else
            {
                <div class="preview text-center">
                    <img class="preview-img" src="http://simpleicon.com/wp-content/uploads/account.png" alt="Preview Image" width="200" height="200" />
                    <div class="browse-button">
                        <i class="fa fa-pencil-alt"></i>
                        <input class="browse-input" required type="file" asp-for="PictureFile" />
                    </div>
                </div>
            }

            <div class="form-group">
                <label asp-for="Username"></label>
                <input asp-for="Username" class="form-control" disabled />
            </div>
            <div class="form-group">
                <label asp-for="Input.FirstName"></label>
                <input asp-for="Input.FirstName" class="form-control" />
            </div>
            <div class="form-group">
                <label asp-for="Input.MiddleName"></label>
                <input asp-for="Input.MiddleName" class="form-control" />
            </div>
            <div class="form-group">
                <label asp-for="Input.FamilyName"></label>
                <input asp-for="Input.FamilyName" class="form-control" />
            </div>
            <div class="form-group">
                <label asp-for="Input.PhoneNumber"></label>
                <input asp-for="Input.PhoneNumber" class="form-control" />
                <span asp-validation-for="Input.PhoneNumber" class="text-danger"></span>
            </div>
            <button id="update-profile-button" type="submit" class="btn btn-primary">Save</button>
        </form>
    </div>
</div>

@section Scripts {
    <style>
        .preview {
            padding: 10px;
            position: relative;
        }

            .preview i {
                color: white;
                font-size: 35px;
                transform: translate(50px,130px);
                margin-left: -8px;
            }

        .preview-img {
            border-radius: 100%;
            box-shadow: 0px 0px 5px 2px rgba(0,0,0,0.7);
        }

        .browse-button {
            width: 200px;
            height: 200px;
            border-radius: 100%;
            position: absolute; /* Tweak the position property if the element seems to be unfit */
            top: 10px;
            left: 98px;
            background: linear-gradient(180deg, transparent, black);
            opacity: 0;
            transition: 0.3s ease;
        }

            .browse-button:hover {
                opacity: 1;
            }

        .browse-input {
            width: 200px;
            height: 200px;
            border-radius: 100%;
            transform: translate(-1px,-26px);
            opacity: 0;
        }

        .form-group {
            width: 250px;
            margin: 10px auto;
        }

            .form-group input {
                transition: 0.3s linear;
            }

                .form-group input:focus {
                    border: 1px solid crimson;
                    box-shadow: 0 0 0 0;
                }
    </style>
    <partial name="_ValidationScriptsPartial" />
}